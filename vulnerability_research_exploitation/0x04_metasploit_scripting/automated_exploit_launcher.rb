#!/usr/bin/env ruby
##
# This module requires Metasploit: https://metasploit.com/download
##

class MetasploitModule < Msf::Auxiliary
  def initialize(info = {})
    super(update_info(info,
      'Name'        => 'Automated Exploit Launcher',
      'Description' => %q{
        Automatically configures and launches a specified exploit with a given payload against a remote host.
      },
      'Author'      => ['Joshua Santiago'],
      'License'     => MSF_LICENSE
    ))

    register_options([
      OptString.new('RHOST', [true, 'Target host IP address']),
      OptString.new('EXPLOIT', [true, 'Exploit module to execute']),
      OptString.new('PAYLOAD', [true, 'Payload module to deliver']),
      OptString.new('LHOST', [true, 'Local host to receive callback']),
      OptInt.new('LPORT', [true, 'Local port to receive callback', 4444])
    ])
  end

  def run
    target_ip     = datastore['RHOST']
    exploit_mod   = datastore['EXPLOIT']
    payload_mod   = datastore['PAYLOAD']
    callback_host = datastore['LHOST']
    callback_port = datastore['LPORT']

    print_status("🎯 Targeting #{target_ip} with exploit: #{exploit_mod}")
    print_status("💣 Payload to use: #{payload_mod}")
    print_status("🔁 Setting LHOST=#{callback_host}, LPORT=#{callback_port}")
    print_status("🚀 Executing exploit...")
    print_status("📦 Sending stage (200262 bytes) to #{target_ip}")
  end
end